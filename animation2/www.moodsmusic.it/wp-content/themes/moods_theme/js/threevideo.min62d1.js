function VideoManager(){}function initVideo(){$=jQuery;var e=$(window);container=document.createElement("div"),container.id="video-container",document.body.appendChild(container),camera=new THREE.PerspectiveCamera(50,window.innerWidth/window.innerHeight,1,1e4),camera.position.set(0,0,500),scene=new THREE.Scene,center=new THREE.Vector3,center.z=-500,video=document.createElement("video"),video.addEventListener("loadedmetadata",function(n){texture=new THREE.VideoTexture(video),texture.minFilter=THREE.NearestFilter;var t=e.width()>=1600?1200:800,i=e.width()>=1600?900:600,r=parseInt(window.innerWidth*t/1200),o=parseInt(i/t*r),a=r,d=o,m=850,c=4e3;geometry=new THREE.BufferGeometry;for(var s=new Float32Array(a*d*3),u=0,w=0,l=s.length;l>u;u+=3,w++)s[u]=w%a,s[u+1]=Math.floor(w/a);geometry.addAttribute("position",new THREE.BufferAttribute(s,3)),material=new THREE.ShaderMaterial({uniforms:{map:{type:"t",value:texture},width:{type:"f",value:a},height:{type:"f",value:d},nearClipping:{type:"f",value:m},farClipping:{type:"f",value:c},pointSize:{type:"f",value:2},zOffset:{type:"f",value:1e3}},vertexShader:document.getElementById("vs").textContent,fragmentShader:document.getElementById("fs").textContent,blending:THREE.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),mesh=new THREE.Points(geometry,material),scene.add(mesh)},!1),video.loop=!0,video.src=Globals.templateUri+"/video/moods.webm",renderer=new THREE.WebGLRenderer,renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(window.innerWidth,window.innerHeight),container.appendChild(renderer.domElement),mouse=new THREE.Vector3(0,0,1),document.addEventListener("mousemove",onDocumentMouseMove,!1),window.addEventListener("resize",onWindowResize,!1)}function onWindowResize(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function onDocumentMouseMove(e){mouse.x=2*(e.clientX-window.innerWidth/2),mouse.y=2*(e.clientY-window.innerHeight/2)}function animate(){requestAnimationFrame(animate),render()}function render(){camera.position.x+=.05*(mouse.x-camera.position.x),camera.position.y+=.05*(-mouse.y-camera.position.y),camera.lookAt(center),renderer.render(scene,camera)}var container,scene,camera,light,renderer,geometry,cube,mesh,material,mouse,center,video,texture;VideoManager.startVideo=function(){Detector.webgl?(initVideo(),animate()):document.body.appendChild(Detector.getWebGLErrorMessage())},VideoManager.playVideo=function(){video.play()};